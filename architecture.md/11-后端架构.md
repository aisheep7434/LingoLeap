# 11. 后端架构

## 服务架构

  * **函数组织**: tRPC 路由将按功能领域存放在 `src/server/api/routers/` 目录下。
  * **函数模板**: 每个路由文件都将遵循 tRPC 的标准模式来定义程序。

## 数据库架构

  * **Schema 设计**: 遵循第 9 节的 SQL DDL。
  * **数据访问层**: 使用 Prisma 作为类型安全的 ORM。

## 认证与授权

  * **认证流程**: 由 Supabase Auth 管理。
  * **中间件/守卫**: 在 Next.js 中间件和 tRPC 的 `protectedProcedure` 两个层面执行保护。
